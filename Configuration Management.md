**CONFIGURATION MANAGEMENT**

- Configuration management - систематичен (автоматизиран) метод за менажиране на групи от машини
- Идемпотентност - внася промяна, само когато трябва да се промени нещо. Ако то вече е в състоянието, което искаме, CM-a не прави нищо. 
- Идемпотентността води до повтаряемост, предвидимост, error handling и ефикасност.

**Защо CM**
- При CM кодът трябва да е Single Source of Truth 
- Съответно всяка една промяна е записана, което ни дава Traceability 
- Ефективност - намалява полето за човешка грешка
- Compliance - помага при спазването на регулаторни изисквания и стандарти
- Reproducibility - всичко, което сме описали в код, можем да reproduce-нем 1:1

**Best practices**
- Документация, change control, **автоматизация**, модулярност, регулярен одитинг и лесен hand over (training)
- Можем да генерираме Compliance reports през CM
- CM не започва като процес top to bottom
- Трябва да се случват регулярни синкове със Single Source of Truth за да няма configuration drift 

**Common uses**
- Провизиране на сървъри
    - Акцент върху бързина, при нужда от скалиране 
- CI//CD - автоматизираме software deployment 
- CM помага с идентифицирането на configuration drift
- Помага при Disaster Recovery (IRL case: намаля DR от 4 часа до 10 минути)
- (отново) Помага при compliance 

**Common tools**
- Ansible, Chef, Puppet
    - Ansible няма паралелизъм, има само асинхронност. Няма агент.
    - Chef конфигурацията се описва в RUBY, но има агент.
    - Puppet се пише на RUBY и също иска агент

**ANSIBLE**
- yaml - чете се лесно
- няма агент
- иска SSH или WinRM
- Генерира python код, който се копира на target машините и се execute-ва локално

- Task: single unit within a play, нещо дребно, команда, копиране на файл, и т.н.
- Playbook: съвкупност от task-ове
- Module: модулите разширяват функционалността на task-овете. Има модули за VMWare, AWS, и т.н.
- Inventory: статичен или динамичен инвентар (hosts.ini). При динамичен инвентар използваме label-и
- Variables: мястото с най-нисък приоритет е в default на ролите. В CMD има най-висок приоритет
- Facts: информацията, която Ансибъл събира от машините
- Roles: групира няколко playbooks
    - defaults - default променливи
    - templates - дефолт конфизи, могат да се ползват в зависимост от нуждата 
    - files - файловете, които ролята търси стандартно при copy операции
    - tasks - main.yaml, съдържа всички task-ове, които ролята да изпълни
- Handlers - таскове, които се рънват в зависимост от състоянието на други таскове (пр. when:...)
- Vault - internal secrets management


**command line variables имат най-висок приоритет. Това може да се използва за да се взимат неща като променливи, които впоследствие да се ползват в плейбука при CI//CD процес**

**Ролите следват определена структура на директориите. Във всяка папка слагаме main.yaml**

**handlers: в ./handlers/main.yaml се слага команда, която да се тригърва от промяна, съответно в playbook-a се използва notify: който специфицира кой handler да се използва при промяна в определен блок**

**handler-a е със синтакс на абсолютно нормален таск, но заради структурата на папките е със специален статут, съответно и от там notify знае къде да го търси**

